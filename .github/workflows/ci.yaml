name: CI

on:
  push:
    branches: [ main, actions, bazel ]
  pull_request:
    branches: [ main, actions, bazel ]

env:
  TEST_STATS_DELAY: 5000

jobs:
  test:
    name: Test
    runs-on: ubuntu-latest
    services:
      rabbitmq:
        image: pivotalrabbitmq/rabbitmq:main-otp-max-bazel
        ports:
        - 15672
    steps:
    - name: CHECKOUT
      uses: actions/checkout@v3
    - name: TEST
      run: |
        bazel test //...
